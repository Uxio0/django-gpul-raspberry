{% extends "core/index.html" %}
{% block title %}Raspberries{% endblock %}
{% block head%}
<script>
$(function() {
	var temperatureUrl = '{% url 'raspberry-data' object.id 'temperature' %}';
	var humidityUrl = '{% url 'raspberry-data' object.id 'humidity' %}';
	var bars = [{url: temperatureUrl, bar: $('#temperature'), unit: 'ÂºC'},
				{url: humidityUrl, bar: $('#humidity'), unit: '%'}];
	var test = {{ data_list_json | safe }};

	window.setInterval(function(){
		bars.forEach(function(item) {
			$.get(item.url, function(data) {
				item.bar.text(data.value + item.unit).attr('aria-valuenow', data.value).css('width', data.value + '%');
			});
		});
	}, 2000);
});
</script>
{% endblock %}
{% block content %}
<div class='page-header'>
	<h1>Raspberries</h1>
</div>
<div class='row'>
	<div class='col-md-3'></div>
	<div class='col-md-6'>
		<div class="progress">
			  <div id='temperature'
				  class="progress-bar progress-bar-success" role="progressbar"
				  aria-valuenow="0" aria-valuemin="0"
				  aria-valuemax="100"
				  style="min-width: 2em;">0C</div>
		</div>
		<div class="progress">
			  <div id='humidity'
				  class="progress-bar" role="progressbar"
				  aria-valuenow="0" aria-valuemin="0"
				  aria-valuemax="100"
				  style="min-width: 2em;">0%</div>
		</div>
	</div>
</div>
<div class='row'>
<div class='col-md-12'>
<table class='table table-bordered table-striped'>
	<thead>
		<tr>
			<th>Created</th>
			<th>Name</th>
			<th>Value</th>
		</tr>
	</thead>
	<tbody>
		{% for data in data_list %}
		<tr>
			<td>{{ data.created }}</td>
			<td>{{ data.name }}</td>
			<td>{{ data.value}}</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
</div>
</div>
{% endblock %}
