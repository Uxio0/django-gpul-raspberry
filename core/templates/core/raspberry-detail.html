{% extends "core/index.html" %}
{% block title %}Raspberries{% endblock %}
{% block head%}
<script>
$(function() {
	var temperatureUrl = '{% url 'raspberry-data' object.id 'temperature' %}';
	var humidityUrl = '{% url 'raspberry-data' object.id 'humidity' %}';
	var bars = [{url: temperatureUrl, bar: $('#temperature'), unit: 'ÂºC'},
				{url: humidityUrl, bar: $('#humidity'), unit: '%'}];
	var test = {{ data_list_json | safe }};

	window.setInterval(function(){
		bars.forEach(function(item) {
			$.get(item.url, function(data) {
				item.bar.text(data.value + item.unit).attr('aria-valuenow', data.value).css('width', data.value + '%');
			});
		});
	}, 2000);
});
</script>
{% endblock %}
{% block content %}
<div class='page-header'>
	<h1>Raspberries</h1>
	<a href='{% url 'raspberry-data-stored' object.id %}'>See data</h1>
</div>
<div class='row'>
	<div class='col-md-4'>
		<div class="progress">
			  <div id='temperature'
				  class="progress-bar progress-bar-success" role="progressbar"
				  aria-valuenow="0" aria-valuemin="0"
				  aria-valuemax="100"
				  style="min-width: 2em;">0C</div>
		</div>
	</div>
	<div class='col-md-4'>
		<div class="progress">
			  <div id='humidity'
				  class="progress-bar" role="progressbar"
				  aria-valuenow="0" aria-valuemin="0"
				  aria-valuemax="100"
				  style="min-width: 2em;">0%</div>
		</div>
	</div>
</div>
<div class='row'>
	<div class='col-md-4'>
		<canvas id="temperatureChart"></canvas>
	</div>
	<div class='col-md-4'>
		<canvas id="humidityChart"></canvas>
	</div>
</div>
{% endblock %}
